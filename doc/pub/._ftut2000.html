<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="More Advanced FEniCS Finite Element Programming">
<meta name="keywords" content="assembly, increasing efficiency,Online Python Tutor,nonlinear variational problems,Gateaux derivative,automatic differentiation,Jacobian, automatic computation,Picard iteration,successive substitutions,Newton's method (algebraic equations),under-relaxation,Jacobian, manual computation,Newton's method (PDE level),mesh transformations,coordinate stretching,coordinate transformations,FEniCS,DOLFIN,Viper,UFL,class,instance,method (class),attribute (class),down-casting matrices and vectors,PETSc,Trilinos,Epetra,troubleshooting,compilation problems,plotting problems">

<title>More Advanced FEniCS Finite Element Programming</title>

<!-- Bootstrap style: bootswatch_journal -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/journal/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

body { font-size:20px;line-height:1.5; }
</style>


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [(u'Developing a more advanced heat equation solver',
               0,
               u'ch:diffusion',
               u'ch:diffusion'),
              (u'Optimization of algorithms and implementations',
               1,
               u'ch:diffusion:opt',
               u'ch:diffusion:opt'),
              (u'Avoiding some assembly',
               2,
               u'ch:diffusion:opt:bassembly',
               u'ch:diffusion:opt:bassembly'),
              (u'Avoiding all assembly',
               2,
               u'ch:diffusion:opt:noassembly',
               u'ch:diffusion:opt:noassembly'),
              (u'Deriving recursive linear systems', 3, None, '___sec4'),
              (u'FEniCS implementation', 3, None, '___sec5'),
              (u'A welding example with post processing and animation',
               1,
               u'ch:diffusion:welding',
               u'ch:diffusion:welding'),
              (u'Post processing data and saving to file',
               2,
               u'ch:diffusion:welding:cbcpost',
               u'ch:diffusion:welding:cbcpost'),
              (u'Installation', 3, None, '___sec8'),
              (u'Basic commands', 3, None, '___sec9'),
              (u'Heat transfer due to a moving welding source',
               2,
               u'ch:diffusion:welding:problem',
               u'ch:diffusion:welding:problem'),
              (u'Scaling of the welding problem',
               2,
               u'ch:diffusion:welding:scaling',
               u'ch:diffusion:welding:scaling'),
              (u'A function-based solver',
               2,
               u'ch:diffusion:welding:funcsolver',
               u'ch:diffusion:welding:funcsolver'),
              (u'Implementing PDE solvers as classes',
               0,
               u'ch:classes',
               u'ch:classes'),
              (u'Refactoring a Poisson solver in terms of classes',
               1,
               u'ch:poisson0:refactor:class',
               u'ch:poisson0:refactor:class'),
              (u'The solver class',
               2,
               u'ch:poisson0:refactor:class:solver',
               u'ch:poisson0:refactor:class:solver'),
              (u'A problem class',
               2,
               u'ch:poisson0:refactor:class:problem0',
               u'ch:poisson0:refactor:class:problem0'),
              (u'A more complicated problem class',
               2,
               u'ch:poisson0:refactor:class:problem1',
               u'ch:poisson0:refactor:class:problem1'),
              (u'Refactoring a heat equation solver',
               1,
               u'ch:diffusion:refactor',
               u'ch:diffusion:refactor'),
              (u'Problem 1: Find error in implementation',
               2,
               None,
               '___sec19'),
              (u'Mathematical problem',
               2,
               u'ch:diffusion:refactor:math',
               u'ch:diffusion:refactor:math'),
              (u'Superclass for problems',
               2,
               u'ch:diffusion:refactor:class_solver',
               u'ch:diffusion:refactor:class_solver'),
              (u'A specific problem class', 2, None, '___sec22'),
              (u'The solver class', 2, None, '___sec23'),
              (u'Applications to heat conduction', 1, None, '___sec24'),
              (u'Thermal boundary layer', 2, None, '___sec25'),
              (u'Mathematics', 3, None, '___sec26'),
              (u'FEniCS implementation', 3, None, '___sec27'),
              (u'Results', 3, None, '___sec28'),
              (u'Extension to a heterogeneous medium', 2, None, '___sec29'),
              (u'Updated scaling', 3, None, '___sec30'),
              (u'The problem class', 3, None, '___sec31'),
              (u'Results', 3, None, '___sec32'),
              (u'Oscillating boundary temperature', 2, None, '___sec33'),
              (u'Scaling', 3, None, '___sec34'),
              (u'The problem class', 3, None, '___sec35'),
              (u'Results', 3, None, '___sec36'),
              (u'Exercise 2: Implement second-order schemes in time',
               2,
               None,
               '___sec37'),
              (u'Implementing solvers for nonlinear PDEs',
               0,
               u'ftut:nonlinear',
               u'ftut:nonlinear'),
              (u'Test problem', 3, None, '___sec39'),
              (u'The built-in automated Newton solver',
               1,
               u'ch:poisson0:nonlinear',
               u'ch:poisson0:nonlinear'),
              (u'Computing the Jacobian', 2, None, '___sec41'),
              (u'Setting solver parameters', 2, None, '___sec42'),
              (u'FEniCS implementation', 2, None, '___sec43'),
              (u'Manual implementation of solution algorithms',
               1,
               None,
               '___sec44'),
              (u'Picard iteration',
               2,
               u'ftut:nonlinear:Picard',
               u'ftut:nonlinear:Picard'),
              (u'Idea', 3, None, '___sec46'),
              (u'Variational formulation', 3, None, '___sec47'),
              (u'Stopping criteria', 3, None, '___sec48'),
              (u'FEniCS implementation', 3, None, '___sec49'),
              (u'A Newton method at the algebraic level',
               2,
               u'ftut:nonlinear:Newton:algebraic',
               u'ftut:nonlinear:Newton:algebraic'),
              (u'Identifying the variational formulation of the linearized problem',
               3,
               None,
               '___sec51'),
              (u'FEniCS implementation', 3, None, '___sec52'),
              (u'A Newton method at the PDE level',
               2,
               u'ftut:nonlinear:Newton:pdelevel',
               u'ftut:nonlinear:Newton:pdelevel'),
              (u'The mathematical method', 3, None, '___sec54'),
              (u'FEniCS implementation', 3, None, '___sec55'),
              (u'Implementations with functions and classes',
               2,
               None,
               '___sec56'),
              (u'Exercise 3: Solve another nonlinear Poisson problem',
               2,
               u'ftut:nonlinear:exer:Poissonwfu',
               u'ftut:nonlinear:exer:Poissonwfu'),
              (u'Mixed finite element programming',
               0,
               u'ch:mixedFEM',
               u'ch:mixedFEM'),
              (u'High-performance computing', 0, u'ch:HPC', u'ch:HPC'),
              (u'More old stuff', 0, None, '___sec60'),
              (u'Solving Neumann problems', 1, None, '___sec61'),
              (u'Transforming hypercube domains',
               1,
               u'ftut:prepro',
               u'ftut:prepro'),
              (u'Coordinate stretching', 2, None, '___sec63'),
              (u'Rectangle to hollow circle mapping', 2, None, '___sec64'),
              (u'Encyclopedia stuff', 1, None, '___sec65'),
              (u'Glossary', 2, None, '___sec66'),
              (u'Overview of objects and functions', 2, None, '___sec67'),
              (u'Handy methods in key FEniCS objects', 2, None, '___sec68'),
              (u'Mesh', 3, None, '___sec69'),
              (u'Function space', 3, None, '___sec70'),
              (u'Function', 3, None, '___sec71'),
              (u'Using a backend-specific solver',
               2,
               u'ftut:Epetra',
               u'ftut:Epetra'),
              (u'Troubleshooting', 0, u'ftut:trouble', u'ftut:trouble'),
              (u'Compilation Problems', 1, None, '___sec74'),
              (u'Problems with the Instant cache', 2, None, '___sec75'),
              (u'Syntax errors in expressions', 2, None, '___sec76'),
              (u'Example', 3, None, '___sec77'),
              (u'An Integral without a Domain is now illegal',
               2,
               None,
               '___sec78'),
              (u'Problems in the solve step', 2, None, '___sec79'),
              (u'Unable to convert object to a UFL form',
               2,
               None,
               '___sec80'),
              (u'UFL reports that a numpy array cannot be converted to any UFL type',
               2,
               None,
               '___sec81'),
              (u'All programs fail to compile', 2, None, '___sec82'),
              (u'Problems with Expression Objects', 1, None, '___sec83'),
              (u'There seems to be some bug in an Expression object',
               2,
               None,
               '___sec84'),
              (u'Segmentation fault when using an Expression object',
               2,
               None,
               '___sec85'),
              (u'Other Problems', 1, None, '___sec86'),
              (u'Very strange error message involving a `mesh` variable',
               2,
               None,
               '___sec87'),
              (u'The plot disappears quickly from the screen',
               2,
               None,
               '___sec88'),
              (u'Only parts of the program are executed',
               2,
               None,
               '___sec89'),
              (u'Error in the definition of the boundary',
               2,
               None,
               '___sec90'),
              (u'The solver in a nonlinear problems does not converge',
               2,
               None,
               '___sec91'),
              (u'How To Debug a FEniCS Program?', 1, None, '___sec92'),
              (u'To-do list', 1, None, '___sec93'),
              (u'AL list', 2, None, '___sec94'),
              (u'HPL questions', 2, None, '___sec95'),
              (u'Iterative linear solvers info', 3, None, '___sec96'),
              (u'Bibliography', 1, None, '___sec97')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands.tex -->
$$
\newcommand{\dt}{\Delta t}
\newcommand{\tp}{\thinspace .}
\newcommand{\x}{\boldsymbol{x}}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d}s}
\newcommand{\ub}{u_{\mathrm{b}}}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="ftut2.html">More Advanced FEniCS Finite Element Programming</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:diffusion" style="font-size: 80%;"><b>Developing a more advanced heat equation solver</b></a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:diffusion:opt" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Optimization of algorithms and implementations</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:diffusion:opt:bassembly" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Avoiding some assembly</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:diffusion:opt:noassembly" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Avoiding all assembly</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Deriving recursive linear systems</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FEniCS implementation</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:diffusion:welding" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A welding example with post processing and animation</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:diffusion:welding:cbcpost" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Post processing data and saving to file</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec8" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Installation</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec9" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic commands</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:diffusion:welding:problem" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Heat transfer due to a moving welding source</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:diffusion:welding:scaling" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling of the welding problem</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:diffusion:welding:funcsolver" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A function-based solver</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:classes" style="font-size: 80%;"><b>Implementing PDE solvers as classes</b></a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:poisson0:refactor:class" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Refactoring a Poisson solver in terms of classes</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:poisson0:refactor:class:solver" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The solver class</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:poisson0:refactor:class:problem0" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A problem class</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:poisson0:refactor:class:problem1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A more complicated problem class</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:diffusion:refactor" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Refactoring a heat equation solver</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem 1: Find error in implementation</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:diffusion:refactor:math" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mathematical problem</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#ch:diffusion:refactor:class_solver" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Superclass for problems</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec22" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A specific problem class</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec23" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The solver class</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec24" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Applications to heat conduction</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec25" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thermal boundary layer</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec26" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mathematics</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec27" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FEniCS implementation</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Results</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec29" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Extension to a heterogeneous medium</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec30" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Updated scaling</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec31" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The problem class</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec32" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Results</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec33" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oscillating boundary temperature</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec34" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec35" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The problem class</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec36" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Results</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2002.html#___sec37" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 2: Implement second-order schemes in time</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#ftut:nonlinear" style="font-size: 80%;"><b>Implementing solvers for nonlinear PDEs</b></a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec39" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Test problem</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#ch:poisson0:nonlinear" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The built-in automated Newton solver</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec41" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Computing the Jacobian</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec42" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setting solver parameters</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec43" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FEniCS implementation</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec44" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Manual implementation of solution algorithms</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#ftut:nonlinear:Picard" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Picard iteration</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec46" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Idea</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec47" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Variational formulation</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec48" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Stopping criteria</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec49" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FEniCS implementation</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#ftut:nonlinear:Newton:algebraic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A Newton method at the algebraic level</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec51" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Identifying the variational formulation of the linearized problem</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec52" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FEniCS implementation</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#ftut:nonlinear:Newton:pdelevel" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A Newton method at the PDE level</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec54" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The mathematical method</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec55" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FEniCS implementation</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#___sec56" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementations with functions and classes</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#ftut:nonlinear:exer:Poissonwfu" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exercise 3: Solve another nonlinear Poisson problem</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#ch:mixedFEM" style="font-size: 80%;"><b>Mixed finite element programming</b></a></li>
     <!-- navigation toc: --> <li><a href="._ftut2003.html#ch:HPC" style="font-size: 80%;"><b>High-performance computing</b></a></li>
     <!-- navigation toc: --> <li><a href="._ftut2004.html#___sec60" style="font-size: 80%;"><b>More old stuff</b></a></li>
     <!-- navigation toc: --> <li><a href="._ftut2005.html#___sec61" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Solving Neumann problems</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2005.html#ftut:prepro" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Transforming hypercube domains</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2005.html#___sec63" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coordinate stretching</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2005.html#___sec64" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rectangle to hollow circle mapping</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2005.html#___sec65" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Encyclopedia stuff</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2005.html#___sec66" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Glossary</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2005.html#___sec67" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Overview of objects and functions</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2005.html#___sec68" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Handy methods in key FEniCS objects</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2005.html#___sec69" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mesh</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2005.html#___sec70" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Function space</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2005.html#___sec71" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Function</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2005.html#ftut:Epetra" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using a backend-specific solver</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#ftut:trouble" style="font-size: 80%;"><b>Troubleshooting</b></a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec74" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Compilation Problems</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec75" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problems with the Instant cache</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec76" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Syntax errors in expressions</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec77" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec78" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An Integral without a Domain is now illegal</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec79" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problems in the solve step</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec80" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unable to convert object to a UFL form</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec81" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UFL reports that a numpy array cannot be converted to any UFL type</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec82" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;All programs fail to compile</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec83" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Problems with Expression Objects</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec84" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;There seems to be some bug in an Expression object</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec85" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Segmentation fault when using an Expression object</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec86" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Other Problems</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec87" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Very strange error message involving a <code>mesh</code> variable</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec88" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The plot disappears quickly from the screen</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec89" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Only parts of the program are executed</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec90" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error in the definition of the boundary</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec91" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The solver in a nonlinear problems does not converge</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2006.html#___sec92" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;How To Debug a FEniCS Program?</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2007.html#___sec93" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;To-do list</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2007.html#___sec94" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AL list</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2007.html#___sec95" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HPL questions</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2007.html#___sec96" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iterative linear solvers info</a></li>
     <!-- navigation toc: --> <li><a href="._ftut2008.html#___sec97" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Bibliography</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0000"></a>
<!-- ------------------- main content ---------------------- -->

<p>


<div class="jumbotron">
<center><h1>More Advanced FEniCS Finite Element Programming</h1></center>  <!-- document title -->

<!-- - Writing Advanced State-of-the-Art Finite Element Solvers in Hours -->

<p>
<!-- author(s): Hans Petter Langtangen, and Anders Logg -->

<center>
<b>Hans Petter Langtangen</b> [1, 2] (<tt>hpl at simula.no</tt>)
</center>

<center>
<b>Anders Logg</b> [3, 1] (<tt>logg at chalmers.se</tt>)
</center>

<p>
<!-- institution(s) -->

<center>[1] <b>Center for Biomedical Computing, Simula Research Laboratory</b></center>
<center>[2] <b>Department of Informatics, University of Oslo</b></center>
<center>[3] <b>Department of Mathematics, Chalmers University of Technology</b></center>
<br>

<p>
<!-- Can refer to ftut1 as with the xr package in latex (just use ref{} and cite{}) -->
<!-- Externaldocuments: ftut1 -->

<p>
This book addresses...

<p>
<center><h4>Apr 29, 2016</h4></center> 
<!-- date -->
<br>
<p>


<p><a href="._ftut2001.html" class="btn btn-primary btn-lg">Read &raquo;</a></p>


</div> <!-- end jumbotron -->

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
  <li class="active"><a href="._ftut2000.html">1</a></li>
  <li><a href="._ftut2001.html">2</a></li>
  <li><a href="._ftut2002.html">3</a></li>
  <li><a href="._ftut2003.html">4</a></li>
  <li><a href="._ftut2004.html">5</a></li>
  <li><a href="._ftut2005.html">6</a></li>
  <li><a href="._ftut2006.html">7</a></li>
  <li><a href="._ftut2007.html">8</a></li>
  <li><a href="._ftut2008.html">9</a></li>
  <li><a href="._ftut2001.html">&raquo;</a></li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright --> &copy; 2016, Hans Petter Langtangen, Anders Logg. Released under CC Attribution 4.0 license
</center>


</body>
</html>
    

